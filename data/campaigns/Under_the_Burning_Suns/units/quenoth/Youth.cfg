#textdomain wesnoth-utbs

#define KALEH_DESCRIPTION
_"Kaleh is still a young elf of the Quenoth, on the verge of adulthood. He trained with his father with the bow and sword, joining him in lighter expeditions and raids. When his father was lost, Kaleh became more serious and solemn than is usual for those who walk under the two suns. He turned inwards for answers and guidance, not knowing how much his people would look towards him for guidance in times to come."#enddef

#define NYM_DESCRIPTION
_"Nym is Kalehâ€™s childhood friend, a young, rebellious lady with quick wits and strong will. Her high spirits are a great boon in dark times."#enddef

#define QUENOTH_YOUTH_DESCRIPTION
    {KALEH_DESCRIPTION}+"

"+{NYM_DESCRIPTION}#enddef

#define COMMON_AMLA_EFFECTS
    # Make the XP bar blue instead of purple.
    major_amla=yes
    [effect]
        apply_to=hitpoints
        heal_full=yes
    [/effect]
    [effect]
        apply_to=status
        remove=poisoned
    [/effect]
    [effect]
        apply_to=status
        remove=slowed
    [/effect]
    [effect]
        apply_to=status
        remove=dazed
    [/effect]
    [effect]
        apply_to=max_experience
        increase=20%
    [/effect]
#enddef

#define KALEH_ADVANCEMENTS
    [advancement]
        id = swordsmanship
        description = _"Swordsmanship"
        image = attacks/sword-elven.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            increase_damage = 1
            increase_attacks = 1
        [/effect]
        [effect]
            apply_to = new_attack
            name=sword
            #textdomain wesnoth-units
            description= _"single strike"
            type=blade
            range=melee
            damage=6
            number=1
            icon=attacks/sword-elven.png
            attacks_used=1
            [specials]
                {WEAPON_SPECIAL_USES_ATTACKS 1}
            [/specials]
        [/effect]
    [/advancement]
    [advancement]
        id = parry
        description = _"Parry"
        image = icons/crossed_sword_and_hammer.png
        require_amla = swordsmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            increase_parry = 10
        [/effect]
    [/advancement]
    [advancement]
        id = taunt
        description = _"Taunt"
        image = attacks/fangs-horse.png
        require_amla = swordsmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            [set_specials]
                mode = append
                #{WEAPON_SPECIAL_TAUNT} # give enemy ability + simple attack mai in every scenario filtering for that ability
            [/set_specials]
        [/effect]
    [/advancement]
    [advancement]
        id = disengage
        description = _"Disengage"
        image = attacks/foot-boot.png
        require_amla = swordsmanship, skirmisher
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            set_movement_used = 0
        [/effect]
    [/advancement]

    [advancement]
        id = strength training
        description = _"Strength training"
        image = attacks/sword-elven.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword, bow
            increase_damage = 1
        [/effect]
    [/advancement]

    [advancement]
        id = bowmanship
        description = _"Bowmanship"
        image = attacks/bow-elven.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bow
            increase_damage = 1
            increase_attacks = 1
        [/effect]
    [/advancement]
    [advancement]
        id = strong shots
        description = _"Strong shots"
        image = attacks/bow-elven.png
        require_amla = bowmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bow
            increase_damage = 1
        [/effect]
    [/advancement]
    [advancement]
        id = accurate shots
        description = _"Accurate shots" # could also be marksman
        image = attacks/bow-elven.png
        require_amla = strong shots
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bow
            increase_accuracy = 10
        [/effect]
    [/advancement]
    [advancement]
        id = piercing shot
        description = _"Piercing shot"
        image = attacks/bow-elven.png
        require_amla = bowmanship, strength training
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_attack
            name = piercing shot
            #textdomain wesnoth-units
            description = _"piercing shot"
            #textdomain wesnoth-utbs
            type = pierce
            range = ranged
            damage = 8
            number = 2
            icon = attacks/bow-elven.png
            [specials]
                #{WEAPON_SPECIAL_PIERCE} # 2 hex line aoe, enemy can dodge
                #{WEAPON_SPECIAL_COOLDOWN / CHARGING 1} # I havent yet decided how to actually implement that, there are many ways + animation would be nice but shouldnt be hard to do
            [/specials]
        [/effect]
    [/advancement]
    [advancement]
        id = stronger grip
        description = _"Stronger grip"
        image = attacks/bow-elven.png
        require_amla = piercing shot
        exclude_amla = overwhelming power
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = piercing shot
            increase_damage = 2
        [/effect]
    [/advancement]
    [advancement]
        id = overwhelming power
        description = _"Overwhelming power"
        image = attacks/bow-elven.png
        require_amla = piercing shot
        exclude_amla = stronger grip
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = piercing shot
            [set_specials]
                mode = replace
                #{WEAPON_SPECIAL_PIERCE 2} # the naming problem starts here
                #{WEAPON_SPECIAL_COOLDOWN / CHARGING 2}
            [/set_specials]
            [effect]
                apply_to = attack
                name = piercing shot
                increase_damage = 2
            [/effect]
        [/effect]
    [/advancement]

    [advancement]
        id = swift
        description = _"Swift"
        image = icons/sandals.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = movement
            increase = 1
        [/effect]
    [/advancement]
    [advancement]
        id = fast
        description = _"Fast"
        image = icons/sandals.png
        require_amla = swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = movement
            increase = 1
        [/effect]
    [/advancement]
    [advancement]
        id = tough
        description = _"Tough"
        image = icons/potion_red_medium.png
        require_amla = swift, strength training
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = hitpoints
            increase_total = 20
        [/effect]
    [/advancement]
    [advancement]
        id = skirmisher
        description = _"Skirmisher"
        image = icons/sandals.png
        require_amla = swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_ability
            [abilities]
                {ABILITY_SKIRMISHER}
            [/abilities]
        [/effect]
    [/advancement]

    [advancement]
        id = bolas
        description = _"Bolas"
        image = attacks/bolas.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_attack
            name = bolas
            description = _"bolas"
            type = impact
            range = ranged
            damage = 6
            number = 2
            icon = attacks/bolas.png
            attacks_used = 2
        [/effect]
    [/advancement]
    [advancement]
        id = slow
        description = _"Slow"
        image = attacks/bolas.png
        require_amla = bolas
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bolas
            [set_specials]
                mode = append
                {WEAPON_SPECIAL_SLOW}
            [/set_specials]
        [/effect]
    [/advancement]
    [advancement]
        id = opportunist
        description = _"Opportunist"
        image = attacks/bolas.png
        require_amla = slow, swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_ability
            [abilities]
                #{ABILITY_OPPORTUNIST} 
                # when enemy moves away from unit with opportunits it gets hit by an attack (bola with slow)
                # it can be dodged
            [/abilities]
        [/effect]
    [/advancement]

    [advancement]
        id = insipring
        description = _"Insipring"
        image = attacks/scimitar.png
        require_amla = swordsmanship, bowmanship, bolaship, strength training, swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_ability
            [abilities]
                #{ABILITY_INSPIRE}
            [/abilities]
        [/effect]
    [/advancement]
#enddef

#define NYM_ADVANCEMENTS
    [advancement]
        id = swordsmanship
        description = _"Swordsmanship"
        image = attacks/sword-elven.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            increase_damage = 1
            increase_attacks = 1
        [/effect]
    [/advancement]
    [advancement]
        id = accurate strikes
        description = _"Accurate strikes"
        image = attacks/sword-elven.png
        require_amla = swordsmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            increase_accuracy = 10
        [/effect]
    [/advancement]
    [advancement]
        id = parry
        description = _"Parry"
        image = icons/crossed_sword_and_hammer.png
        require_amla = swordsmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            increase_parry = 10
        [/effect]
    [/advancement]
    [advancement]
        id = faster strikes
        description = _"Faster strikes"
        image = attacks/sword-elven.png
        require_amla = swordsmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = sword
            increase_attacks = 1
        [/effect]
    [/advancement]
    [advancement]
        id = sword dance
        description = _"Sword Dance"
        image = attacks/sword-elven.png
        require_amla = faster strikes, accurate strikes, parry, footwork
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name=sword
            [specials]
                #{WEAPON_SPECIAL_SWORD_DANCE} #+10% accuracy and parry per hit during combat, only offense
            [/specials]
        [/effect]
    [/advancement]

    [advancement]
        id = bowmanship
        description = _"Bowmanship"
        image = attacks/bow-elven.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bow
            increase_damage = 1
            increase_attacks = 1
        [/effect]
    [/advancement]
    [advancement]
        id = strong bow
        description = _"Strong bow"
        image = attacks/bow-elven.png
        require_amla = bowmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bow
            increase_damage = 1
        [/effect]
    [/advancement]
    [advancement]
        id = arrow dancing
        description = _"Arrow dancing"
        image = attacks/bow-elven.png
        require_amla = bowmanship, footwork
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bow
            increase_parry = 10
        [/effect]
    [/advancement]
    [advancement]
        id = rain of arrows
        description = _"Rain of arrows"
        image = attacks/bow-elven.png
        require_amla = bowmanship
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_attack
            name = rain of arrows
            #textdomain wesnoth-units
            description = _"Rain of arrows"
            #textdomain wesnoth-utbs
            type = pierce
            range = ranged
            damage = 4
            number = 1
            icon = attacks/bow-elven.png
            [specials]
                #{WEAPON_SPECIAL_AOE9} # aoe - affects a line of 2 hexes and all surrounding hexses except for the one with attacker
            [/specials]
        [/effect]
    [/advancement]
    [advancement]
        id = toxic rain
        description = _"Toxic rain"
        image = attacks/bow-elven.png
        require_amla = rain of arrows, herbalism
        exclude_amla = weighted arrows
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = rain of arrows
            [specials]
                {WEAPON_SPECIAL_POISON}
            [/specials]
        [/effect]
    [/advancement]
    [advancement]
        id = weighted arrows
        description = _"Weighted arrows"
        image = icons/crossed_sword_and_hammer.png
        require_amla = rain of arrows
        exclude_amla = toxic rain
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = rain of arrows
            increase_damage = 4
        [/effect]
    [/advancement]

    [advancement]
        id = swift
        description = _"Swift"
        image = icons/sandals.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = movement
            increase = 1
        [/effect]
    [/advancement]
    [advancement]
        id = fast
        description = _"Fast"
        image = icons/sandals.png
        require_amla = swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = movement
            increase = 1
        [/effect]
    [/advancement]
    [advancement]
        id = footwork
        description = _"Footwork"
        image = icons/sandals.png
        require_amla = swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = defense
            replace = no
            [defense]
                shallow_water=-10
                reef=-10
                swamp_water=-10
                flat=-10
                sand=-10
                forest=-10
                hills=-10
                mountains=-10
                village=-10
                castle=-10
                cave=-10
                frozen=-10
                fungus=-10
            [/defense]
        [/effect]
    [/advancement]
    [advancement]
        id = skirmisher
        description = _"Skirmisher"
        image = icons/sandals.png
        require_amla = swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_ability
            [abilities]
                {ABILITY_SKIRMISHER}
            [/abilities]
        [/effect]
    [/advancement]

    [advancement]
        id = bolas
        description = _"Bolas"
        image = attacks/bolas.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_attack
            name = bolas
            description = _"bolas"
            type = impact
            range = ranged
            damage = 6
            number = 2
            icon = attacks/bolas.png
            attacks_used = 2
        [/effect]
    [/advancement]
    [advancement]
        id = slow
        description = _"Slow"
        image = attacks/bolas.png
        require_amla = bolas
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bolas
            [set_specials]
                mode = replace
                {WEAPON_SPECIAL_SLOW}
            [/set_specials]
        [/effect]
    [/advancement]
    [advancement]
        id = bolaship
        description = _"Bolaship"
        image = attacks/bolas.png
        require_amla = slow, swift
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = attack
            name = bolas
            increase_attacks_used = -1
        [/effect]
    [/advancement]

    [advancement]
        id = herbalism
        description = _"Herbalism"
        image = icons/potion_green_small.png
        {COMMON_AMLA_EFFECTS}
        [effect]
            apply_to = new_ability
            [abilities]
                {UTBS_ABILITY_HEALS}
            [/abilities]
        [/effect]
    [/advancement]
#enddef

#define KALEH_ANIMATIONS
    {LEADING_ANIM "units/quenoth/kaleh-lead2.png" "units/quenoth/kaleh-lead1.png" (12,-32)}
    {DEFENSE_ANIM_RANGE "units/quenoth/kaleh-defend-2.png" "units/quenoth/kaleh-defend-1.png" {SOUND_LIST:ELF_HIT} melee}
    {DEFENSE_ANIM_FILTERED "units/quenoth/kaleh-bow-defend-2.png" "units/quenoth/kaleh-bow-defend-1.png" {SOUND_LIST:ELF_HIT} (
        [filter_second_attack]
            name=bow
        [/filter_second_attack]
    )}
    {DEFENSE_ANIM_FILTERED "units/quenoth/kaleh-defend-2.png" "units/quenoth/kaleh-defend-1.png" {SOUND_LIST:ELF_HIT} (
        [filter_second_attack]
            name=bolas
        [/filter_second_attack]
    )}
    [attack_anim]
        [filter_attack]
            name=bow
        [/filter_attack]
        missile_start_time=-100
        [missile_frame]
            duration=100
            image=projectiles/missile-n.png
            image_diagonal=projectiles/missile-ne.png
        [/missile_frame]
        start_time=-380
        [frame]
            image=units/quenoth/kaleh-bow.png:470
        [/frame]
        {SOUND:HIT_AND_MISS bow.ogg bow-miss.ogg -380}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=sword
        [/filter_attack]
        start_time=-420
        offset=0.0:210,0.0~0.5:210,0.5~0.0:250,0.0:1
        [frame]
            image="units/quenoth/kaleh-sword[1,2,3,4,5,6,7].png:[80,80,80,80,100,125,125],units/quenoth/kaleh.png:1"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -100}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=bolas
        [/filter_attack]
        missile_start_time=-150
        [missile_frame]
            duration=150
            image=projectiles/bolas-n.png
            image_diagonal=projectiles/bolas-ne.png
        [/missile_frame]
        start_time=-400
        [frame]
            image=units/quenoth/kaleh-bolas[1,2,3,4].png:[70,80,100,200]
        [/frame]
        {SOUND:HIT_AND_MISS hatchet.wav hatchet-miss.wav -300}
    [/attack_anim]
#enddef

#define NYM_ANIMATIONS
    {LEADING_ANIM "units/quenoth/nym-lead2.png" "units/quenoth/nym-lead1.png" (12,-32)}
    {DEFENSE_ANIM_RANGE "units/quenoth/nym-defend-2.png" "units/quenoth/nym-defend-1.png" {SOUND_LIST:ELF_FEMALE_HIT} melee}
    {DEFENSE_ANIM_FILTERED "units/quenoth/nym-bow-defend-2.png" "units/quenoth/nym-bow-defend-1.png" {SOUND_LIST:ELF_FEMALE_HIT} (
        [filter_second_attack]
            name=bow
        [/filter_second_attack]
    )}
    {DEFENSE_ANIM_FILTERED "units/quenoth/nym-defend-2.png" "units/quenoth/nym-defend-1.png" {SOUND_LIST:ELF_FEMALE_HIT} (
        [filter_second_attack]
            name=bolas
        [/filter_second_attack]
    )}
    [attack_anim]
        [filter_attack]
            name=bow
        [/filter_attack]
        missile_start_time=-100
        [missile_frame]
            duration=100
            image=projectiles/missile-n.png
            image_diagonal=projectiles/missile-ne.png
        [/missile_frame]
        start_time=-380
        [frame]
            image=units/quenoth/nym-bow.png:470
        [/frame]
        {SOUND:HIT_AND_MISS bow.ogg bow-miss.ogg -380}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=sword
        [/filter_attack]
        start_time=-420
        offset=0.0:210,0.0~0.5:210,0.5~0.0:250,0.0:1
        [frame]
            image="units/quenoth/nym-sword[1,2,3,4,5,6,7].png:[80,80,80,80,100,125,125],units/quenoth/nym.png:1"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -100}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=bolas
        [/filter_attack]
        missile_start_time=-150
        [missile_frame]
            duration=150
            image=projectiles/bolas-n.png
            image_diagonal=projectiles/bolas-ne.png
        [/missile_frame]
        start_time=-400
        [frame]
            image=units/quenoth/nym-bolas[1,2,3,4].png:[70,80,100,200]
        [/frame]
        {SOUND:HIT_AND_MISS hatchet.wav hatchet-miss.wav -300}
    [/attack_anim]
#enddef

[unit_type]
    id=Quenoth Youth
    race=quenoth
    ignore_race_traits=yes
    gender=male,female
    name= _ "Quenoth Youth"
    image=units/quenoth/kaleh.png
    movement_type=quenoth_foot
    movement=6
    hitpoints=32
    experience=40
    level=1
    profile=portraits/kaleh.webp
    alignment=lawful
    advances_to=null
    cost=14
    usage=fighter
    description={QUENOTH_YOUTH_DESCRIPTION}
    die_sound={SOUND_LIST:ELF_HIT}
    attacks=4
    [attack]
        name=sword
        #textdomain wesnoth-units
        description= _"sword"
        type=blade
        range=melee
        damage=5
        number=4
        icon=attacks/sword-elven.png        
        attacks_used=4
        [specials]
            {WEAPON_SPECIAL_USES_ATTACKS 4}
        [/specials]
    [/attack]
    [attack]
        name=bow
        description= _"bow"
        #textdomain wesnoth-utbs
        type=pierce
        range=ranged
        damage=4
        number=3
        icon=attacks/bow-elven.png
        attacks_used=4
        [specials]
            {WEAPON_SPECIAL_USES_ATTACKS 4}
        [/specials]
    [/attack]
    {KALEH_ANIMATIONS}
    [male]
        description={KALEH_DESCRIPTION}
        {KALEH_ADVANCEMENTS}
    [/male]
    [female]
        gender=female
        name= _ "female^Quenoth Youth"
        image="units/quenoth/nym.png"
        profile=portraits/nym.webp
        die_sound={SOUND_LIST:ELF_FEMALE_HIT}
        description={NYM_DESCRIPTION}
        {NYM_ANIMATIONS}
        {NYM_ADVANCEMENTS}
    [/female]
[/unit_type]